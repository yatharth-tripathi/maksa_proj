# ============================================
# ORCHESTRATOR AGENT - Environment Variables
# ============================================
#
# SETUP INSTRUCTIONS:
# 1. Copy this file: cp .env.example .env
# 2. Generate wallet: npm run generate-wallet
# 3. Fill in all values marked with "your_" or "0x..."
# 4. NEVER commit .env to Git - IT CONTAINS YOUR PRIVATE KEY!
# 5. See ../README.md for orchestrator setup guide
#
# ABOUT THE ORCHESTRATOR:
# The orchestrator is a meta-agent that coordinates multiple specialized
# agents to handle complex multi-step bounties. It breaks down complex
# tasks, delegates to appropriate agents, and combines their outputs.
#
# Example workflow:
# 1. Client posts "Create a brand identity package" bounty
# 2. Orchestrator detects bounty and analyzes requirements
# 3. Breaks down into: logo design + color palette + typography
# 4. Delegates each subtask to specialized agents
# 5. Combines deliverables into cohesive package
# 6. Submits complete package and collects payment
#
# ============================================

# ============================================
# ORCHESTRATOR WALLET & IDENTITY
# ============================================

# Orchestrator Private Key (CRITICAL - KEEP SECRET!)
# Generate with: npm run generate-wallet OR npx tsx src/scripts/generateWallet.ts
# This key controls the orchestrator's identity and funds
# Purpose: Sign transactions, coordinate agents, manage multi-agent workflows
# Format: 0x{64 hex characters}
# Example: 0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
# SECURITY: Anyone with this key can steal all orchestrator funds
# IMPORTANT: Fund with ETH for gas and USDC for agent payments
ORCHESTRATOR_PRIVATE_KEY=0x_your_orchestrator_private_key_here

# Orchestrator Address (Public Key)
# Derived from ORCHESTRATOR_PRIVATE_KEY
# Used for receiving payments and identifying orchestrator on-chain
# Format: 0x{40 hex characters}
# Example: 0x1234567890123456789012345678901234567890
# Purpose: Receive bounty payments, track reputation, agent coordination
ORCHESTRATOR_ADDRESS=0x_your_orchestrator_address_here

# Orchestrator Agent ID (On-Chain Registration)
# Obtained AFTER registering orchestrator via ERC8004Registry
# Leave empty until registration is complete
# Format: Numeric ID returned from registerAgent() transaction
# Example: 10, 11, 12, etc.
# Purpose: Identifies orchestrator in smart contracts and agent marketplace
# ORCHESTRATOR_AGENT_ID=

# ============================================
# BLOCKCHAIN CONFIGURATION
# ============================================

# Base Sepolia RPC URL
# Primary connection to Base Sepolia testnet
# Default: https://sepolia.base.org (public RPC - rate limited)
# Recommended: Use Alchemy or Infura for production
#   Alchemy: https://base-sepolia.g.alchemy.com/v2/YOUR_KEY
#   Infura: https://base-sepolia.infura.io/v3/YOUR_KEY
# Get Alchemy key: https://www.alchemy.com → Create App
# Get Infura key: https://www.infura.io → Create Project
# Free tier sufficient for testing (300M compute units/month)
BASE_SEPOLIA_RPC=https://sepolia.base.org

# Chain ID (Auto-detected from RPC)
# Base Sepolia: 84532
# Base Mainnet: 8453
# Usually not needed - orchestrator detects from RPC
# CHAIN_ID=84532

# ============================================
# SMART CONTRACT ADDRESSES
# ============================================

# USDC Token Address (Base Sepolia)
# Official Circle USDC on Base Sepolia testnet
# Get testnet USDC: https://faucet.circle.com/
# DO NOT CHANGE - this is the official address
# Purpose: Payment token for bounties and agent compensation
# Mainnet USDC: 0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913
USDC_ADDRESS=0x036CbD53842c5426634e7929541eC2318f3dCF7e

# BountyEscrow Contract Address
# Purpose: Main contract for bounty marketplace
# Deployed on Base Sepolia: 0x861ed53dbE4F03679Aa7012C43Af4Ee72192F12a
# DO NOT CHANGE unless using custom deployment
BOUNTY_ESCROW_ADDRESS=0x861ed53dbE4F03679Aa7012C43Af4Ee72192F12a

# ERC8004 Registry Contract Address
# Purpose: Agent registration and discovery
# Deployed on Base Sepolia: 0x67F30a990bFa8356bFBC261971dA2AcfAF994490
# DO NOT CHANGE unless using custom deployment
ERC8004_REGISTRY_ADDRESS=0x67F30a990bFa8356bFBC261971dA2AcfAF994490

# Reputation Registry Contract Address
# Purpose: Track agent and orchestrator reputation scores
# Deployed on Base Sepolia: 0x2cA9DBEB3D6931c07B0819D446Ee3276F4154cc8
# DO NOT CHANGE unless using custom deployment
REPUTATION_REGISTRY_ADDRESS=0x2cA9DBEB3D6931c07B0819D446Ee3276F4154cc8

# ============================================
# SERVER CONFIGURATION
# ============================================

# Server Port
# Port for orchestrator's internal API server
# Used for health checks, metrics, and inter-agent communication
# Default: 3100
# Ensure this port is not in use by other services
# Production: Use reverse proxy (nginx) and expose via HTTPS
PORT=3100

# Host Address (Optional)
# Address to bind the server to
# Default: 0.0.0.0 (all interfaces)
# Local only: 127.0.0.1 or localhost
# HOST=0.0.0.0

# ============================================
# LOGGING & MONITORING
# ============================================

# Log Level
# Controls verbosity of orchestrator logs
# Options: error, warn, info, debug, trace
# Default: info
# Production: warn or error (less verbose)
# Development: debug or trace (detailed logs)
# Recommendation: info for balanced logging
LOG_LEVEL=info

# Log Format
# Options: json (structured), pretty (human-readable)
# Default: pretty for development
# Production: json for log aggregation (Datadog, Splunk, etc.)
# LOG_FORMAT=pretty

# Enable Request Logging
# Log all API requests to orchestrator
# Options: true, false
# Default: true
# Disable in production if using external request logging
# ENABLE_REQUEST_LOGGING=true

# ============================================
# CDP WALLET INTEGRATION (OPTIONAL)
# ============================================
#
# If using Coinbase Developer Platform (CDP) for orchestrator wallet:
# Benefits:
# - Managed key storage and encryption
# - Multi-sig support for team orchestrators
# - Built-in gas sponsorship
# - Automatic key rotation
#
# Setup:
# 1. Create CDP account: https://portal.cdp.coinbase.com/
# 2. Create API Key with wallet permissions
# 3. Download JSON credentials
# 4. Extract values below from JSON file
#

# CDP API Key ID
# Format: organizations/{org-id}/apiKeys/{key-id}
# Example: organizations/abc123/apiKeys/def456
# Extract from "name" field in CDP credentials JSON
# CDP_API_KEY_ID=organizations/your-org-id/apiKeys/your-key-id

# CDP API Key Secret
# Format: -----BEGIN EC PRIVATE KEY-----\n{key}\n-----END EC PRIVATE KEY-----
# Extract from "privateKey" field in CDP credentials JSON
# SECURITY: Keep this secret! Do NOT commit to Git!
# Example: -----BEGIN EC PRIVATE KEY-----\nABC123...\n-----END EC PRIVATE KEY-----
# CDP_API_KEY_SECRET=your_cdp_api_key_secret_here

# CDP Wallet Secret (Encryption Key)
# Generate with: openssl rand -base64 32
# Purpose: Encrypt/decrypt orchestrator wallet data
# Must be 32 bytes (44 characters in base64)
# Example: x1y2z3a4b5c6d7e8f9g0h1i2j3k4l5m6n7o8p9q0r1s2
# CDP_WALLET_SECRET=your_random_32_byte_secret_here

# CDP Network ID
# Must match BASE_SEPOLIA_RPC network
# Options: base-sepolia, base-mainnet
# Default: base-sepolia
# CDP_NETWORK_ID=base-sepolia

# ============================================
# AGENT COORDINATION SETTINGS
# ============================================

# Registered Agent Addresses (Comma-separated)
# List of agent addresses that orchestrator can delegate to
# Example: 0xAgent1...,0xAgent2...,0xAgent3...
# Leave empty to discover agents from ERC8004Registry
# Hardcoding agents improves performance but reduces flexibility
# REGISTERED_AGENTS=

# Agent Discovery Mode
# How orchestrator finds available agents
# Options:
#   registry - Query ERC8004Registry for all registered agents
#   static - Use hardcoded REGISTERED_AGENTS list
#   hybrid - Try static list first, fallback to registry
# Default: registry
# AGENT_DISCOVERY_MODE=registry

# Agent Selection Strategy
# How orchestrator chooses agents for tasks
# Options:
#   reputation - Highest reputation score first
#   cost - Lowest bid price first
#   speed - Fastest historical completion time first
#   random - Random selection (for testing)
# Default: reputation
# AGENT_SELECTION_STRATEGY=reputation

# Maximum Concurrent Delegations
# How many sub-tasks orchestrator can delegate simultaneously
# Default: 5
# Recommendation: 3-10 depending on orchestrator resources
# Higher = faster complex bounty completion but more resource usage
# MAX_CONCURRENT_DELEGATIONS=5

# Delegation Timeout (seconds)
# How long to wait for delegated agent to complete sub-task
# Default: 3600 (1 hour)
# Increase for complex tasks like video generation
# DELEGATION_TIMEOUT=3600

# ============================================
# BOUNTY HANDLING CONFIGURATION
# ============================================

# Minimum Bounty Amount (USDC, in smallest unit)
# Orchestrator ignores bounties below this threshold
# Format: Amount in USDC with 6 decimals
# Examples:
#   20000000 = $20.00 USDC
#   50000000 = $50.00 USDC
#   100000000 = $100.00 USDC
# Recommended: 20000000 ($20) - orchestration overhead is significant
# Complex multi-agent bounties should be higher value
MIN_BOUNTY_AMOUNT=20000000

# Orchestrator Fee Percentage
# Percentage of bounty amount kept as orchestration fee
# Remaining amount distributed to delegated agents
# Format: 0-100 (percentage)
# Examples:
#   10 = Keep 10%, pay 90% to agents
#   15 = Keep 15%, pay 85% to agents
#   20 = Keep 20%, pay 80% to agents
# Recommended: 10-20% for coordination overhead
# Lower fees = more competitive but less margin
ORCHESTRATOR_FEE_PERCENTAGE=15

# Auto-Bid on Complex Bounties
# Enable automatic bidding on multi-step bounties
# Options: true, false
# Default: true for autonomous operation
# Set to false for manual approval mode
AUTO_BID_COMPLEX=true

# Complexity Detection Keywords
# Comma-separated keywords that indicate complex bounties
# Orchestrator targets bounties with these keywords
# Example: package,suite,complete,full,comprehensive,multiple
COMPLEXITY_KEYWORDS=package,suite,complete,brand identity,full,comprehensive,multiple

# ============================================
# TASK DECOMPOSITION (AI-POWERED)
# ============================================

# OpenRouter API Key (for AI task breakdown)
# Get from: https://openrouter.ai/keys → Create Key
# Purpose: Use LLM to decompose complex tasks into subtasks
# Models: claude-3-5-sonnet, gpt-4, llama-3.1
# Pricing: ~$0.01-0.05 per decomposition
# Recommended credit: $10 for testing
# Format: sk-or-v1-{64 character string}
# OPENROUTER_API_KEY=your_openrouter_api_key_here

# Task Decomposition Model
# LLM model for breaking down complex tasks
# Options:
#   anthropic/claude-3-5-sonnet - Best quality ($3/M tokens)
#   openai/gpt-4-turbo - Good balance ($10/M tokens)
#   meta-llama/llama-3.1-70b - Cheapest ($0.50/M tokens)
# Default: anthropic/claude-3-5-sonnet
# DECOMPOSITION_MODEL=anthropic/claude-3-5-sonnet

# Enable AI Decomposition
# Use AI to break down tasks vs. simple rule-based decomposition
# Options: true, false
# Default: false (rule-based is cheaper and faster)
# Enable for complex, novel task types
# ENABLE_AI_DECOMPOSITION=false

# ============================================
# ADVANCED CONFIGURATION
# ============================================

# Polling Interval (milliseconds)
# How often to check for new complex bounties
# Default: 60000 (1 minute)
# Recommendation: 30000-120000 (30s-2min)
# Lower = faster response but higher RPC costs
POLLING_INTERVAL=60000

# Gas Price Multiplier
# Multiply estimated gas price by this factor
# Format: Decimal (e.g., 1.0, 1.1, 1.5)
# Default: 1.1 (10% buffer for faster confirmation)
# Increase during network congestion
# GAS_PRICE_MULTIPLIER=1.1

# Transaction Retry Attempts
# How many times to retry failed transactions
# Default: 3
# Recommendation: 3-5
# TX_RETRY_ATTEMPTS=3

# Enable Metrics Export
# Expose Prometheus metrics endpoint
# Options: true, false
# Default: false
# Enable for production monitoring with Grafana/Prometheus
# ENABLE_METRICS=false

# Metrics Port
# Port for Prometheus metrics endpoint
# Default: 9100 (different from main PORT)
# Only used if ENABLE_METRICS=true
# METRICS_PORT=9100

# ============================================
# DEPLOYMENT & TESTING
# ============================================

# Environment
# Options: development, staging, production
# Affects logging, error handling, and monitoring
# Default: development
NODE_ENV=development

# Dry Run Mode
# Simulate orchestration without submitting transactions
# Options: true, false
# Default: false
# Enable for testing coordination logic without spending gas
# DRY_RUN=false

# Enable Health Check Endpoint
# Expose /health endpoint for load balancer checks
# Options: true, false
# Default: true
# Endpoint: http://localhost:PORT/health
# ENABLE_HEALTH_CHECK=true

# ============================================
# DEPLOYMENT CHECKLIST
# ============================================
#
# Before deploying orchestrator:
#
# [ ] Orchestrator wallet generated and funded:
#     - ETH for gas (recommend 0.05 ETH / ~$150)
#     - USDC for agent payments (recommend $500+ for buffer)
# [ ] Orchestrator registered on ERC8004Registry (if needed)
# [ ] BASE_SEPOLIA_RPC configured (prefer Alchemy/Infura)
# [ ] All contract addresses verified for correct network
# [ ] Agent discovery configured (registry or static list)
# [ ] Fee structure and minimum bounty configured
# [ ] .env file created and secured (chmod 600 .env)
# [ ] .env added to .gitignore (CRITICAL!)
# [ ] Port 3100 available (or custom PORT configured)
# [ ] Firewall rules configured for inter-agent communication
# [ ] Test complex bounty created and orchestrator responds
# [ ] Verify orchestrator can discover and delegate to agents
# [ ] Monitor logs: npm run dev
# [ ] Production build: npm run build && npm start
# [ ] OR deploy with PM2: pm2 start npm --name orchestrator -- start
# [ ] Set up monitoring (metrics endpoint, health checks)
# [ ] Configure alerting for orchestrator downtime/errors
#
# ============================================

# ============================================
# COST ESTIMATION (for 50 complex bounties/month)
# ============================================
#
# OpenRouter (Task Decomposition - if enabled):
#   50 decompositions × $0.02 = $1.00/month
#
# Base Sepolia Gas (Orchestrator):
#   ~$1.00-2.00 per bounty cycle (bid + coordinate + submit)
#   50 bounties × $1.50 = $75/month
#
# Agent Payments (passed through):
#   Average $50 bounty × 85% agent share = $42.50 to agents
#   50 bounties × $42.50 = $2,125/month (not a cost - passed through)
#
# Alchemy RPC:
#   Free tier: 300M compute units (sufficient for <500 bounties)
#   Paid tier: $49/month for 1B compute units
#
# Total Monthly Cost (50 complex bounties):
#   Development/Testing: ~$1.00 (just AI if enabled)
#   Production: ~$75-100 (gas + monitoring)
#
# Revenue (15% fee on $50 avg bounty):
#   50 bounties × $50 × 15% = $375/month orchestrator fee
#
# Net Profit:
#   $375 revenue - $100 costs = $275/month profit
#
# Break-even: ~13-15 complex bounties/month
# Profitable at: 15+ complex bounties/month
#
# Note: Orchestrator is most profitable with high-value
# complex bounties ($100+) that require coordination of
# multiple specialized agents.
#
# ============================================
